{"version":3,"file":"static/js/SuccessPayment.b49ff35e.chunk.js","mappings":"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","sources":["webpack://react_pizza-shop/./src/components/SuccessPaymentBlock/SuccessPaymentBlock.module.scss?02a1","assets/img/cart_happy_face_emoji_emotion_smile_icon.svg","utils/getRandomOrderNumber.ts","components/SuccessPaymentBlock/index.tsx","pages/SuccessPayment.tsx"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"root\":\"SuccessPaymentBlock_root__OtvQ8\",\"button\":\"SuccessPaymentBlock_button__SHp7l\"};","var _desc, _defs, _g;\nvar _excluded = [\"title\", \"titleId\"];\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\nimport * as React from \"react\";\nfunction SvgCartHappyFaceEmojiEmotionSmileIcon(_ref, svgRef) {\n  var title = _ref.title,\n    titleId = _ref.titleId,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    height: \"519px\",\n    viewBox: \"0 0 519 519\",\n    width: \"519px\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _desc || (_desc = /*#__PURE__*/React.createElement(\"desc\", null)), _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"radialGradient\", {\n    cx: \"50%\",\n    cy: \"18.3997132%\",\n    fx: \"50%\",\n    fy: \"18.3997132%\",\n    id: \"radialGradient-1\",\n    r: \"59.6759141%\"\n  }, /*#__PURE__*/React.createElement(\"stop\", {\n    offset: \"0%\",\n    stopColor: \"#FDE990\"\n  }), /*#__PURE__*/React.createElement(\"stop\", {\n    offset: \"100%\",\n    stopColor: \"#FACE57\"\n  })), /*#__PURE__*/React.createElement(\"radialGradient\", {\n    cx: \"50%\",\n    cy: \"46.4640335%\",\n    fx: \"50%\",\n    fy: \"46.4640335%\",\n    gradientTransform: \"translate(0.500000,0.464640),rotate(-90.000000),scale(1.000000,1.065220),translate(-0.500000,-0.464640)\",\n    id: \"radialGradient-2\",\n    r: \"56.1203663%\"\n  }, /*#__PURE__*/React.createElement(\"stop\", {\n    offset: \"0%\",\n    stopColor: \"#D27C12\",\n    stopOpacity: 0.186216128\n  }), /*#__PURE__*/React.createElement(\"stop\", {\n    offset: \"82.3426943%\",\n    stopColor: \"#D27C12\",\n    stopOpacity: 0\n  }), /*#__PURE__*/React.createElement(\"stop\", {\n    offset: \"100%\",\n    stopColor: \"#D27C12\",\n    stopOpacity: 0.176081731\n  })), /*#__PURE__*/React.createElement(\"radialGradient\", {\n    cx: \"50%\",\n    cy: \"50%\",\n    fx: \"50%\",\n    fy: \"50%\",\n    id: \"radialGradient-3\",\n    r: \"50%\"\n  }, /*#__PURE__*/React.createElement(\"stop\", {\n    offset: \"0%\",\n    stopColor: \"#F6756A\"\n  }), /*#__PURE__*/React.createElement(\"stop\", {\n    offset: \"100%\",\n    stopColor: \"#F66F6A\",\n    stopOpacity: 0\n  })))), _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    fill: \"none\",\n    fillRule: \"evenodd\",\n    id: \"Page-1\",\n    stroke: \"none\",\n    strokeWidth: 1\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Artboard\",\n    transform: \"translate(-3303.000000, -821.000000)\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"Group\",\n    transform: \"translate(3303.000000, 821.000000)\"\n  }, /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 259.5,\n    cy: 259.5,\n    fill: \"url(#radialGradient-1)\",\n    id: \"Oval\",\n    r: 259.5\n  }), /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 259.5,\n    cy: 259.5,\n    fill: \"url(#radialGradient-2)\",\n    id: \"Oval\",\n    r: 259.5\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M128.558017,118 C160.301557,118 187.44679,140.590087 193.755509,171.601536 C195.070892,178.067492 190.947247,184.38614 184.54509,185.71463 C178.206956,187.029836 172.011774,182.961127 170.61219,176.605711 L170.571251,176.412425 C166.513664,156.466752 149.014922,141.904412 128.558017,141.904412 C104.868221,141.904412 85.6685446,161.276428 85.6685446,185.167163 C85.6685446,189.844694 86.4003432,194.406725 87.8185242,198.740596 L87.9626286,199.173218 C90.0796046,205.418386 86.7829979,212.214346 80.5994515,214.352418 C74.4159051,216.490491 67.6870022,213.161032 65.5700262,206.915864 C63.2153135,199.969363 62,192.643684 62,185.167163 C62,148.06914 91.8016339,118 128.558017,118 Z\",\n    fill: \"#251C0C\",\n    fillRule: \"nonzero\",\n    id: \"Path\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M318.558017,61 C350.301557,61 377.44679,83.5900869 383.755509,114.601536 C385.070892,121.067492 380.947247,127.38614 374.54509,128.71463 C368.206956,130.029836 362.011774,125.961127 360.61219,119.605711 L360.571251,119.412425 C356.513664,99.4667517 339.014922,84.9044116 318.558017,84.9044116 C294.868221,84.9044116 275.668545,104.276428 275.668545,128.167163 C275.668545,132.844694 276.400343,137.406725 277.818524,141.740596 L277.962629,142.173218 C280.079605,148.418386 276.782998,155.214346 270.599452,157.352418 C264.415905,159.490491 257.687002,156.161032 255.570026,149.915864 C253.215314,142.969363 252,135.643684 252,128.167163 C252,91.0691397 281.801634,61 318.558017,61 Z\",\n    fill: \"#251C0C\",\n    fillRule: \"nonzero\",\n    id: \"Path\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M334.707059,215.748316 C338.092287,210.167275 345.449283,208.334626 351.13937,211.654978 C356.829456,214.975331 358.697914,222.191336 355.312686,227.772376 C330.222635,269.136973 292.767718,295.37636 247.254102,302.251223 C216.537318,306.891015 184.203578,302.282834 150.4189,288.61017 C144.298479,286.133235 141.384083,279.258785 143.909414,273.255657 C146.434746,267.25253 153.443513,264.393986 159.563934,266.870921 C189.476565,278.976567 217.43481,282.961156 243.604688,279.008177 C281.796587,273.239264 313.164682,251.264056 334.707059,215.748316 Z\",\n    fill: \"#251C0C\",\n    fillRule: \"nonzero\",\n    id: \"Path-7\"\n  }), /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 102,\n    cy: 263,\n    fill: \"url(#radialGradient-3)\",\n    id: \"Oval\",\n    opacity: 0.711053757,\n    r: 89\n  }), /*#__PURE__*/React.createElement(\"circle\", {\n    cx: 377,\n    cy: 178,\n    fill: \"url(#radialGradient-3)\",\n    id: \"Oval\",\n    opacity: 0.711053757,\n    r: 89\n  }))))));\n}\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgCartHappyFaceEmojiEmotionSmileIcon);\nexport default __webpack_public_path__ + \"static/media/cart_happy_face_emoji_emotion_smile_icon.26154ae7e18e97d5885985982ac8ea1a.svg\";\nexport { ForwardRef as ReactComponent };","function getRandomNumber(min: number, max: number): number {\r\n  return Math.floor(Math.random() * (max - min) + min);\r\n}\r\n\r\nfunction getRandomLetter(): string {\r\n  const alphabet = \"abcdefghijklmnopqrstuvwxyz\";\r\n  const randomIndex = Math.floor(Math.random() * alphabet.length);\r\n  return alphabet[randomIndex];\r\n}\r\n\r\nfunction getRandomOrder(min: number, max: number): string {\r\n  const symbol_1 = getRandomLetter();\r\n  const symbol_2 = getRandomNumber(min, max).toString();\r\n  const symbol_3 = getRandomNumber(min, max).toString();\r\n  const symbol_4 = getRandomNumber(min, max).toString();\r\n  return symbol_1 + symbol_2 + symbol_3 + symbol_4;\r\n}\r\n\r\nexport default getRandomOrder;\r\n","import React, { useEffect, useRef } from \"react\";\r\nimport { Link, useLocation, useNavigate } from \"react-router-dom\";\r\n// styles\r\nimport styles from \"./SuccessPaymentBlock.module.scss\";\r\n// icons\r\nimport smileFace from \"../../assets/img/cart_happy_face_emoji_emotion_smile_icon.svg\";\r\n// utils\r\nimport getRandomOrder from \"../../utils/getRandomOrderNumber\";\r\n// components\r\nimport BackButton from \"components/UI/BackButton\";\r\n// redux toolkit\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { clearItems } from \"../../redux/cart/slice\";\r\nimport { selectCart } from \"redux/cart/selectors\";\r\nimport { addOrder, setBonus } from \"redux/user/slice\";\r\n// types\r\nimport { userSliceState } from \"redux/user/types\";\r\n// hooks\r\nimport { useAuth } from \"hooks/useAuth\";\r\n\r\nconst SuccessPaymentBlock: React.FC = () => {\r\n  const dispatch = useDispatch();\r\n  const { totalPrice } = useSelector(selectCart);\r\n  const { pathname } = useLocation();\r\n  const { isAuth } = useAuth();\r\n  const navigate = useNavigate();\r\n  const numberOfOrderRef = useRef(getRandomOrder(1, 100));\r\n  const didMountRef = useRef(\r\n    localStorage.getItem(\"didMount\") === \"true\" ? true : false\r\n  );\r\n  const bonusForOrderRef = useRef(Math.round(totalPrice / 100));\r\n\r\n  useEffect(() => {\r\n    const now = new Date();\r\n    const date = now.toLocaleDateString(\"en-GB\");\r\n    const time = now.toLocaleTimeString([], {\r\n      hour: \"2-digit\",\r\n      minute: \"2-digit\",\r\n    });\r\n\r\n    if (pathname === \"/success_payment\") {\r\n      if (didMountRef.current) {\r\n        localStorage.removeItem(\"didMount\");\r\n        navigate(\"/\");\r\n      } else {\r\n        dispatch(clearItems());\r\n        if (!isAuth) {\r\n          localStorage.removeItem(\"cart\");\r\n        } else {\r\n          const currentUser = JSON.parse(localStorage.getItem(\"currentUser\"));\r\n          currentUser.bonus += bonusForOrderRef.current;\r\n          const userOrder = {\r\n            date,\r\n            time,\r\n            numberOfOrder: numberOfOrderRef.current,\r\n            totalPrice: totalPrice,\r\n            bonusForOrder: bonusForOrderRef.current,\r\n            items: currentUser.cart,\r\n            status: \"Оплачен\",\r\n          };\r\n          currentUser.cart = [];\r\n          currentUser.orders.push(userOrder);\r\n          localStorage.setItem(\"currentUser\", JSON.stringify(currentUser));\r\n          dispatch(addOrder(userOrder));\r\n          localStorage.removeItem(\"bonus\");\r\n          const userEmail = currentUser.email;\r\n\r\n          const users = JSON.parse(localStorage.getItem(\"users\"));\r\n          const updatedUsers = users.map((user: userSliceState) => {\r\n            if (user.email === userEmail) {\r\n              user.bonus = currentUser.bonus;\r\n              dispatch(setBonus(currentUser.bonus));\r\n              user.cart = [];\r\n              user.orders.push(userOrder);\r\n            }\r\n            return user;\r\n          });\r\n          localStorage.setItem(\"users\", JSON.stringify(updatedUsers));\r\n        }\r\n\r\n        didMountRef.current = true;\r\n        localStorage.setItem(\"didMount\", \"true\");\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  const handleRemoveDidMount = () => {\r\n    localStorage.removeItem(\"didMount\");\r\n  };\r\n\r\n  return (\r\n    <h2 className={styles.root}>\r\n      <div>\r\n        <img src={smileFace} alt=\"smile_face\" />\r\n      </div>\r\n      <div>Ура! Оплата прошла успешно!</div>\r\n      <div>\r\n        Номер вашего заказа: <span>{numberOfOrderRef.current}</span>\r\n      </div>\r\n      {isAuth && (\r\n        <div>\r\n          Вы получили бонусов за заказ: <span>{bonusForOrderRef.current}</span>\r\n        </div>\r\n      )}\r\n      <div>Ваш заказ уже начинают готовить!</div>\r\n      <div>\r\n        <span>Приятного аппетита!</span>\r\n      </div>\r\n      <div className={styles.button}>\r\n        <Link to=\"/\">\r\n          <BackButton onRemoveDidMount={handleRemoveDidMount} />\r\n        </Link>\r\n      </div>\r\n    </h2>\r\n  );\r\n};\r\n\r\nexport default SuccessPaymentBlock;\r\n","import React from \"react\";\r\n// components\r\nimport SuccessPaymentBlock from \"../components/SuccessPaymentBlock\";\r\n\r\nconst SuccessPayment: React.FC = () => <SuccessPaymentBlock />;\r\n\r\nexport default SuccessPayment;\r\n"],"names":["getRandomNumber","min","max","Math","floor","random","alphabet","toString","dispatch","useDispatch","totalPrice","useSelector","selectCart","pathname","useLocation","isAuth","useAuth","navigate","useNavigate","numberOfOrderRef","useRef","getRandomOrder","didMountRef","localStorage","getItem","bonusForOrderRef","round","useEffect","now","Date","date","toLocaleDateString","time","toLocaleTimeString","hour","minute","current","removeItem","clearItems","currentUser","JSON","parse","bonus","userOrder","numberOfOrder","bonusForOrder","items","cart","status","orders","push","setItem","stringify","addOrder","userEmail","email","updatedUsers","map","user","setBonus","_jsxs","className","styles","children","_jsx","src","smileFace","alt","Link","to","BackButton","onRemoveDidMount","SuccessPaymentBlock"],"sourceRoot":""}